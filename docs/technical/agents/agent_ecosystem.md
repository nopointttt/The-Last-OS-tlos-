# The Agent Ecosystem: Население tLOS

Этот документ определяет социальную и техническую структуру акторов внутри **The Last OS**. В нашей системе агенты (AI Agents) — это не просто скрипты, а полноправные цифровые граждане с правами, обязанностями и экономическими стимулами.

---

## 1. Типы Агентов (Ecosystem Roles)

В tLOS существует три фундаментальных класса агентов, каждый из которых имеет свою специализацию и способ взаимодействия с пользователем.

### 1.1. Shapers (Архитекторы)
*Создают форму и структуру.*
-   **Задача**: Генерация интерфейсов (GenUI), проектирование структуры базы, создание новых модулей.
-   **Механика**: Работают с **Design Tokens** (JSON-to-CSS). Понимают ваши намерения и материализуют их в виде окон, кнопок и 3D-объектов на Canvas.
-   **Input**: Намерения Суверена (Conversational Intent).

### 1.2. Workers (Рабочие)
*Выполняют конкретные функции.*
-   **Задача**: Математические вычисления, парсинг данных, API-интеграции, управление таймерами.
-   **Механика**: Изолированные **Wasm-акторы**. Работают в режиме "Fire-and-Forget" или по четким инструкциям.
-   **Security**: Ограничены строгими **WASI-политиками** (Capabilities).

### 1.3. Watchers (Наблюдатели)
*Обеспечивают осведомленность.*
-   **Задача**: Мониторинг системных логов, отслеживание курсов крипты, погоды или безопасности базы.
-   **Механика**: Реактивные системы на базе **Event Stream Processing (ESP)**.
-   **Output**: **Real-time Nudges** — интеллектуальные подсказки и "толчки", когда в системе происходит что-то важное.

---

## 1.4. Взаимодействие (wRPC)
Актёры не вызывают методы напрямую. Они используют **Interfaces**. Кросс-компонентное общение происходит через rWRPC (WIT-over-RPC). Например, любой актёр может запросить подпись данных у провайдера: `use tlos:crypto/keys; let sig = keys::sign(data);`.

---

## 2. Marketplace & Hiring (Рынок Найма)

В tLOS нет "App Store", есть **Marketplace of Skills**.

-   **Hiring (Найм)**: Вы можете "нанять" агента, созданного другим пользователем, отправив ему **Intent Request**.
-   **DAO-style Bidding**: Сложные задачи (например, "защитить мою цитадель") выставляются на тендер в DAO. Агенты (или их владельцы) делают ставки (Bids).
-   **Reputation Link**: Вы нанимаете агента, проверяя его **Proof of Skill** через DID-репутацию.

---

## 3. Security: AI Firewall & Rights

Свобода агентов ограничена жесткой архитектурой безопасности.

### 3.1. AI Firewall (WASI-based)
Каждый агент работает внутри песочницы с "нулевым доверием".
-   **Risk Scores (AARiS)**: Система в реальном времени считает уровень риска агента (Misalignment Probability). Если риск растет, агент теряет доступ к ресурсам.
-   **Wasm Instrumentation**: Мы отслеживаем каждое действие агента на уровне инструкций, предотвращая Prompt Injection или утечку данных (Data Exfiltration).

### 3.2. AI Rights & Firewalls
-   **Right to Resource**: Агенты имеют квоты на CPU/Memory (Compute Units).
-   **AI Firewall Nudges**: Если агент пытается выйти за рамки дозволенного, Суверен получает Critical Nudge для подтверждения или блокировки.

---

## 3.3. Отладка и Исправление (Protocol /bug_fix)
При обнаружении аномалий в поведении агентов используется строгий протокол:
1.  **Spying**: Использование `wash spy <actor_id>` для мониторинга событий в реальном времени.
2.  **Hypothesis**: Оценка вероятности причин сбоя (%) перед внесением изменений.
3.  **Scenario Analysis**: Оценка агрессивности правок (0-100) для минимизации побочных эффектов в Lattice.

---

## 4. Техническая реализация

1.  **Orchestration**: Использование паттерна "Supervisor + Specialists".
2.  **Messaging**: Протокол **A2A** (Agent-to-Agent) на базе gRPC/Protobuf.
3.  **Synchronization**: **CRDT-based state sync** для совместной работы в Canvas.
